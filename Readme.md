# 🚀 媒体批量压缩与转码工具 (Media Compressor Pro)

这是一个专为 Windows 环境设计的 **高效媒体处理方案**。由资深程序员提供底层算法思路，利用 AI 协作编码完成。它能够帮助你将庞大的照片库和视频库，在**视觉无损**的前提下，体积减小约 **50%~80%**。

---

## ✨ 核心亮点

- 📷 **图片进化**：
  - 自动将 JPEG/HEIC 转换为 **AVIF**（下一代图像格式）。
  - **色彩修复**：完美解决苹果 HEIC 在 Windows 上的 ICC 色彩偏差问题。
  - **元数据保留**：完整保留拍摄时间、GPS 等 EXIF 信息。
- 🎬 **视频重编码**：
  - 采用 **H.265 (HEVC)** 编码，统一封装为 MP4。
  - 智能码率控制，追求画质与体积的最佳平衡。
- 🛠️ **工业级处理**：
  - 支持 **UTF-8** 全路径，中文字符串无乱码。
  - 基于 PowerShell 7+ 异步处理思路，充分利用多核性能。
  - 内置冲突检测，自动处理文件名重复问题。

---

## 📂 功能概览

| 命令 | 模式 | 描述 |
| :--- | :--- | :--- |
| `zip` | 交互式 | 逐个处理并提示，适合初次使用对比画质 |
| `all` | 自动化 | 全火力全开，处理目录下所有支持的媒体文件 |
| `img` | 纯图片 | 仅扫描并转换图像为 AVIF |
| `video` | 纯视频 | 仅扫描并重编码视频为 H.265 |
| `comp` | 对比 | 快速预览源文件与压缩后文件的质量差异 |
| `clean` | 清理 | 移动源文件至备份目录，并将压缩文件归位 |

---

## 💻 系统要求

- **操作系统**: Windows 10 (22H2+) 或 Windows 11
- **运行环境**: [PowerShell 7.0+](https://github.com/PowerShell/PowerShell/releases) (推荐)
- **底层组件**: 系统需配置好 `ffmpeg` 路径。

---

## 🚀 快速开始

### 1. 初次尝试（推荐）
先在小范围文件夹内运行交互模式，确认画质是否满足你的需求。
该模式转码后的文件就保存在源文件相同的目录里，方便用工具对比转码质量，注意heic文件需要用专业看图软件打开，win11自带的看图软件存在偏色现象，并不是转码过程中引入的偏色，推荐使用XnView。
```batch
media.bat zip "E:\手机相册"
```

### 2. 归档清理
处理完成后，一键将原片移动到硬盘备份目录，源目录只保留压缩版：
```batch
media.bat clean "E:\手机相册" "F:\原始归档"
```
### 3. 自动处理模式
当你信任配置后，可以自动批量处理整个目录：
```batch
media.bat all "E:\手机相册"  "F:\原始归档"
```
---

## ⚠️ 免责声明

> **数据无价，操作需谨慎。**
> 
> 使用前请务必 **自行备份重要源文件**。作者对使用本工具产生的任何数据丢失或硬件损耗不承担法律责任。

---

**Built with ❤️ by Developer & AI Collaboration**
